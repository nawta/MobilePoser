ORB-SLAM3 environment configured.
PYTHONPATH includes: /home/naoto/docker_workspace/MobilePoser/third_party/pyOrbSlam3/pyOrbSlam3/build
LD_LIBRARY_PATH includes: /usr/local/lib
Using system libstdc++.so.6
Checking SLAM availability...
============================================================
SLAM Integration Status
============================================================
ORB-SLAM3 Available: True
Available SLAM Types: mock, real, orb_slam3, adaptive
============================================================

Starting SLAM-integrated training with Nymeria dataset...
Using streaming mode to avoid OOM errors

GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/naoto/.local/lib/python3.12/site-packages/lightning/pytorch/trainer/configuration_validator.py:68: You passed in a `val_dataloader` but have no `validation_step`. Skipping val loop.
wandb: Currently logged in as: nawta1998 to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in checkpoints/slam_nymeria/slam_2025-05-31-21:09:13/wandb/run-20250531_210913-4hqfmdem
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run adaptive_2025-05-31-21:09:13
wandb: ⭐️ View project at https://wandb.ai/nawta1998/mobileposer_slam_adaptive
wandb: 🚀 View run at https://wandb.ai/nawta1998/mobileposer_slam_adaptive/runs/4hqfmdem
INFO:mobileposer.slam_selector:Creating adaptive SLAM interface with real ORB-SLAM3
INFO:mobileposer.models.real_orbslam3:Successfully imported pyOrbSlam

ORB-SLAM3 Copyright (C) 2017-2020 Carlos Campos, Richard Elvira, Juan J. Gómez, José M.M. Montiel and Juan D. Tardós, University of Zaragoza.
ORB-SLAM2 Copyright (C) 2014-2016 Raúl Mur-Artal, José M.M. Montiel and Juan D. Tardós, University of Zaragoza.
This program comes with ABSOLUTELY NO WARRANTY;
This is free software, and you are welcome to redistribute it
under certain conditions. See LICENSE.txt.

Input sensor was set to: Monocular
Loading settings from /home/naoto/docker_workspace/MobilePoser/third_party/pyOrbSlam3/pyOrbSlam3/modules/ORB_SLAM3/Examples/Monocular/TUM1.yaml
	-Loaded camera 1
Camera.newHeight optional parameter does not exist...
Camera.newWidth optional parameter does not exist...
	-Loaded image info
	-Loaded ORB settings
Viewer.imageViewScale optional parameter does not exist...
	-Loaded viewer settings
System.LoadAtlasFromFile optional parameter does not exist...
System.SaveAtlasToFile optional parameter does not exist...
	-Loaded Atlas settings
System.thFarPoints optional parameter does not exist...
	-Loaded misc parameters
----------------------------------
SLAM settings: 
	-Camera 1 parameters (Pinhole): [ 517.306 516.469 318.643 255.314 ]
	-Camera 1 distortion parameters: [  0.262383 -0.953104 -0.005358 0.002628 1.16331 ]
	-Original image size: [ 640 , 480 ]
	-Current image size: [ 640 , 480 ]
	-Sequence FPS: 30
	-Features per image: 1000
	-ORB scale factor: 1.2
	-ORB number of scales: 8
	-Initial FAST threshold: 20
	-Min FAST threshold: 7


Loading ORB Vocabulary. This could take a while...
Vocabulary loaded!

Initialization of Atlas from scratch 
Creation of new map with id: 0
Creation of new map with last KF id: 0
Seq. Name: 
There are 1 cameras in the atlas
Camera 0 is pinhole
INFO:mobileposer.models.real_orbslam3:ORB-SLAM3 monocular system initialized successfully
INFO:mobileposer.models.adaptive_slam:Real ORB-SLAM3 monocular system created successfully
INFO:mobileposer.models.real_orbslam3:Successfully imported pyOrbSlam

ORB-SLAM3 Copyright (C) 2017-2020 Carlos Campos, Richard Elvira, Juan J. Gómez, José M.M. Montiel and Juan D. Tardós, University of Zaragoza.
ORB-SLAM2 Copyright (C) 2014-2016 Raúl Mur-Artal, José M.M. Montiel and Juan D. Tardós, University of Zaragoza.
This program comes with ABSOLUTELY NO WARRANTY;
This is free software, and you are welcome to redistribute it
under certain conditions. See LICENSE.txt.

Input sensor was set to: Monocular-Inertial
Loading settings from /home/naoto/docker_workspace/MobilePoser/third_party/pyOrbSlam3/pyOrbSlam3/modules/ORB_SLAM3/Examples/Monocular-Inertial/EuRoC.yaml
Camera1.k3 optional parameter does not exist...
	-Loaded camera 1
	-Loaded image info
IMU.InsertKFsWhenLost optional parameter does not exist...
	-Loaded IMU calibration
	-Loaded ORB settings
Viewer.imageViewScale optional parameter does not exist...
	-Loaded viewer settings
System.LoadAtlasFromFile optional parameter does not exist...
System.SaveAtlasToFile optional parameter does not exist...
	-Loaded Atlas settings
System.thFarPoints optional parameter does not exist...
	-Loaded misc parameters
----------------------------------
SLAM settings: 
	-Camera 1 parameters (Pinhole): [ 458.654 457.296 367.215 248.375 ]
	-Camera 1 distortion parameters: [  -0.283408 0.0739591 0.00019359 1.76187e-05 ]
	-Original image size: [ 752 , 480 ]
	-Current image size: [ 600 , 350 ]
	-Camera 1 parameters after resize: [  365.947 333.445 292.991 181.107 ]
	-Sequence FPS: 20
	-Gyro noise: 0.00017
	-Accelerometer noise: 0.002
	-Gyro walk: 1.9393e-05
	-Accelerometer walk: 0.003
	-IMU frequency: 200
	-Features per image: 1000
	-ORB scale factor: 1.2
	-ORB number of scales: 8
	-Initial FAST threshold: 20
	-Min FAST threshold: 7


Loading ORB Vocabulary. This could take a while...
Vocabulary loaded!

Initialization of Atlas from scratch 
Creation of new map with id: 1
Creation of new map with last KF id: 0
Seq. Name: 
There are 1 cameras in the atlas
Camera 2 is pinhole
INFO:mobileposer.models.real_orbslam3:ORB-SLAM3 visual_inertial system initialized successfully
INFO:mobileposer.models.adaptive_slam:Real ORB-SLAM3 visual-inertial system created successfully
INFO:mobileposer.models.real_orbslam3:Successfully imported pyOrbSlam

ORB-SLAM3 Copyright (C) 2017-2020 Carlos Campos, Richard Elvira, Juan J. Gómez, José M.M. Montiel and Juan D. Tardós, University of Zaragoza.
ORB-SLAM2 Copyright (C) 2014-2016 Raúl Mur-Artal, José M.M. Montiel and Juan D. Tardós, University of Zaragoza.
This program comes with ABSOLUTELY NO WARRANTY;
This is free software, and you are welcome to redistribute it
under certain conditions. See LICENSE.txt.

Input sensor was set to: Monocular
Loading settings from /home/naoto/docker_workspace/MobilePoser/third_party/pyOrbSlam3/pyOrbSlam3/modules/ORB_SLAM3/Examples/Monocular/TUM1.yaml
	-Loaded camera 1
Camera.newHeight optional parameter does not exist...
Camera.newWidth optional parameter does not exist...
	-Loaded image info
	-Loaded ORB settings
Viewer.imageViewScale optional parameter does not exist...
	-Loaded viewer settings
System.LoadAtlasFromFile optional parameter does not exist...
System.SaveAtlasToFile optional parameter does not exist...
	-Loaded Atlas settings
System.thFarPoints optional parameter does not exist...
	-Loaded misc parameters
----------------------------------
SLAM settings: 
	-Camera 1 parameters (Pinhole): [ 517.306 516.469 318.643 255.314 ]
	-Camera 1 distortion parameters: [  0.262383 -0.953104 -0.005358 0.002628 1.16331 ]
	-Original image size: [ 640 , 480 ]
	-Current image size: [ 640 , 480 ]
	-Sequence FPS: 30
	-Features per image: 1000
	-ORB scale factor: 1.2
	-ORB number of scales: 8
	-Initial FAST threshold: 20
	-Min FAST threshold: 7


Loading ORB Vocabulary. This could take a while...
Vocabulary loaded!

Initialization of Atlas from scratch 
Creation of new map with id: 2
Creation of new map with last KF id: 0
Seq. Name: 
There are 1 cameras in the atlas
Camera 4 is pinhole
Shutdown
INFO:mobileposer.models.real_orbslam3:ORB-SLAM3 monocular system initialized successfully
INFO:mobileposer.models.real_orbslam3:Successfully imported pyOrbSlam

ORB-SLAM3 Copyright (C) 2017-2020 Carlos Campos, Richard Elvira, Juan J. Gómez, José M.M. Montiel and Juan D. Tardós, University of Zaragoza.
ORB-SLAM2 Copyright (C) 2014-2016 Raúl Mur-Artal, José M.M. Montiel and Juan D. Tardós, University of Zaragoza.
This program comes with ABSOLUTELY NO WARRANTY;
This is free software, and you are welcome to redistribute it
under certain conditions. See LICENSE.txt.

Input sensor was set to: Monocular-Inertial
Loading settings from /home/naoto/docker_workspace/MobilePoser/third_party/pyOrbSlam3/pyOrbSlam3/modules/ORB_SLAM3/Examples/Monocular-Inertial/EuRoC.yaml
Camera1.k3 optional parameter does not exist...
	-Loaded camera 1
	-Loaded image info
IMU.InsertKFsWhenLost optional parameter does not exist...
	-Loaded IMU calibration
	-Loaded ORB settings
Viewer.imageViewScale optional parameter does not exist...
	-Loaded viewer settings
System.LoadAtlasFromFile optional parameter does not exist...
System.SaveAtlasToFile optional parameter does not exist...
	-Loaded Atlas settings
System.thFarPoints optional parameter does not exist...
	-Loaded misc parameters
----------------------------------
SLAM settings: 
	-Camera 1 parameters (Pinhole): [ 458.654 457.296 367.215 248.375 ]
	-Camera 1 distortion parameters: [  -0.283408 0.0739591 0.00019359 1.76187e-05 ]
	-Original image size: [ 752 , 480 ]
	-Current image size: [ 600 , 350 ]
	-Camera 1 parameters after resize: [  365.947 333.445 292.991 181.107 ]
	-Sequence FPS: 20
	-Gyro noise: 0.00017
	-Accelerometer noise: 0.002
	-Gyro walk: 1.9393e-05
	-Accelerometer walk: 0.003
	-IMU frequency: 200
	-Features per image: 1000
	-ORB scale factor: 1.2
	-ORB number of scales: 8
	-Initial FAST threshold: 20
	-Min FAST threshold: 7


Loading ORB Vocabulary. This could take a while...
Vocabulary loaded!

Initialization of Atlas from scratch 
Creation of new map with id: 3
Creation of new map with last KF id: 0
Seq. Name: 
There are 1 cameras in the atlas
Camera 6 is pinhole
Shutdown
INFO:mobileposer.models.real_orbslam3:ORB-SLAM3 visual_inertial system initialized successfully
INFO:mobileposer.slam_data_streaming:Initialized adaptive SLAM system
INFO:mobileposer.slam_selector:Creating adaptive SLAM interface with real ORB-SLAM3
INFO:mobileposer.models.real_orbslam3:Successfully imported pyOrbSlam

ORB-SLAM3 Copyright (C) 2017-2020 Carlos Campos, Richard Elvira, Juan J. Gómez, José M.M. Montiel and Juan D. Tardós, University of Zaragoza.
ORB-SLAM2 Copyright (C) 2014-2016 Raúl Mur-Artal, José M.M. Montiel and Juan D. Tardós, University of Zaragoza.
This program comes with ABSOLUTELY NO WARRANTY;
This is free software, and you are welcome to redistribute it
under certain conditions. See LICENSE.txt.

Input sensor was set to: Monocular
Loading settings from /home/naoto/docker_workspace/MobilePoser/third_party/pyOrbSlam3/pyOrbSlam3/modules/ORB_SLAM3/Examples/Monocular/TUM1.yaml
	-Loaded camera 1
Camera.newHeight optional parameter does not exist...
Camera.newWidth optional parameter does not exist...
	-Loaded image info
	-Loaded ORB settings
Viewer.imageViewScale optional parameter does not exist...
	-Loaded viewer settings
System.LoadAtlasFromFile optional parameter does not exist...
System.SaveAtlasToFile optional parameter does not exist...
	-Loaded Atlas settings
System.thFarPoints optional parameter does not exist...
	-Loaded misc parameters
----------------------------------
SLAM settings: 
	-Camera 1 parameters (Pinhole): [ 517.306 516.469 318.643 255.314 ]
	-Camera 1 distortion parameters: [  0.262383 -0.953104 -0.005358 0.002628 1.16331 ]
	-Original image size: [ 640 , 480 ]
	-Current image size: [ 640 , 480 ]
	-Sequence FPS: 30
	-Features per image: 1000
	-ORB scale factor: 1.2
	-ORB number of scales: 8
	-Initial FAST threshold: 20
	-Min FAST threshold: 7


Loading ORB Vocabulary. This could take a while...
Vocabulary loaded!

Initialization of Atlas from scratch 
Creation of new map with id: 4
Creation of new map with last KF id: 0
Seq. Name: 
There are 1 cameras in the atlas
Camera 8 is pinhole
INFO:mobileposer.models.real_orbslam3:ORB-SLAM3 monocular system initialized successfully
INFO:mobileposer.models.adaptive_slam:Real ORB-SLAM3 monocular system created successfully
INFO:mobileposer.models.real_orbslam3:Successfully imported pyOrbSlam

ORB-SLAM3 Copyright (C) 2017-2020 Carlos Campos, Richard Elvira, Juan J. Gómez, José M.M. Montiel and Juan D. Tardós, University of Zaragoza.
ORB-SLAM2 Copyright (C) 2014-2016 Raúl Mur-Artal, José M.M. Montiel and Juan D. Tardós, University of Zaragoza.
This program comes with ABSOLUTELY NO WARRANTY;
This is free software, and you are welcome to redistribute it
under certain conditions. See LICENSE.txt.

Input sensor was set to: Monocular-Inertial
Loading settings from /home/naoto/docker_workspace/MobilePoser/third_party/pyOrbSlam3/pyOrbSlam3/modules/ORB_SLAM3/Examples/Monocular-Inertial/EuRoC.yaml
Camera1.k3 optional parameter does not exist...
	-Loaded camera 1
	-Loaded image info
IMU.InsertKFsWhenLost optional parameter does not exist...
	-Loaded IMU calibration
	-Loaded ORB settings
Viewer.imageViewScale optional parameter does not exist...
	-Loaded viewer settings
System.LoadAtlasFromFile optional parameter does not exist...
System.SaveAtlasToFile optional parameter does not exist...
	-Loaded Atlas settings
System.thFarPoints optional parameter does not exist...
	-Loaded misc parameters
----------------------------------
SLAM settings: 
	-Camera 1 parameters (Pinhole): [ 458.654 457.296 367.215 248.375 ]
	-Camera 1 distortion parameters: [  -0.283408 0.0739591 0.00019359 1.76187e-05 ]
	-Original image size: [ 752 , 480 ]
	-Current image size: [ 600 , 350 ]
	-Camera 1 parameters after resize: [  365.947 333.445 292.991 181.107 ]
	-Sequence FPS: 20
	-Gyro noise: 0.00017
	-Accelerometer noise: 0.002
	-Gyro walk: 1.9393e-05
	-Accelerometer walk: 0.003
	-IMU frequency: 200
	-Features per image: 1000
	-ORB scale factor: 1.2
	-ORB number of scales: 8
	-Initial FAST threshold: 20
	-Min FAST threshold: 7


Loading ORB Vocabulary. This could take a while...
Vocabulary loaded!

Initialization of Atlas from scratch 
Creation of new map with id: 5
Creation of new map with last KF id: 0
Seq. Name: 
There are 1 cameras in the atlas
Camera 10 is pinhole
INFO:mobileposer.models.real_orbslam3:ORB-SLAM3 visual_inertial system initialized successfully
INFO:mobileposer.models.adaptive_slam:Real ORB-SLAM3 visual-inertial system created successfully
INFO:mobileposer.models.real_orbslam3:Successfully imported pyOrbSlam

ORB-SLAM3 Copyright (C) 2017-2020 Carlos Campos, Richard Elvira, Juan J. Gómez, José M.M. Montiel and Juan D. Tardós, University of Zaragoza.
ORB-SLAM2 Copyright (C) 2014-2016 Raúl Mur-Artal, José M.M. Montiel and Juan D. Tardós, University of Zaragoza.
This program comes with ABSOLUTELY NO WARRANTY;
This is free software, and you are welcome to redistribute it
under certain conditions. See LICENSE.txt.

Input sensor was set to: Monocular
Loading settings from /home/naoto/docker_workspace/MobilePoser/third_party/pyOrbSlam3/pyOrbSlam3/modules/ORB_SLAM3/Examples/Monocular/TUM1.yaml
	-Loaded camera 1
Camera.newHeight optional parameter does not exist...
Camera.newWidth optional parameter does not exist...
	-Loaded image info
	-Loaded ORB settings
Viewer.imageViewScale optional parameter does not exist...
	-Loaded viewer settings
System.LoadAtlasFromFile optional parameter does not exist...
System.SaveAtlasToFile optional parameter does not exist...
	-Loaded Atlas settings
System.thFarPoints optional parameter does not exist...
	-Loaded misc parameters
----------------------------------
SLAM settings: 
	-Camera 1 parameters (Pinhole): [ 517.306 516.469 318.643 255.314 ]
	-Camera 1 distortion parameters: [  0.262383 -0.953104 -0.005358 0.002628 1.16331 ]
	-Original image size: [ 640 , 480 ]
	-Current image size: [ 640 , 480 ]
	-Sequence FPS: 30
	-Features per image: 1000
	-ORB scale factor: 1.2
	-ORB number of scales: 8
	-Initial FAST threshold: 20
	-Min FAST threshold: 7


Loading ORB Vocabulary. This could take a while...
Vocabulary loaded!

Initialization of Atlas from scratch 
Creation of new map with id: 6
Creation of new map with last KF id: 0
Seq. Name: 
There are 1 cameras in the atlas
Camera 12 is pinhole
Shutdown
INFO:mobileposer.models.real_orbslam3:ORB-SLAM3 monocular system initialized successfully
INFO:mobileposer.models.real_orbslam3:Successfully imported pyOrbSlam

ORB-SLAM3 Copyright (C) 2017-2020 Carlos Campos, Richard Elvira, Juan J. Gómez, José M.M. Montiel and Juan D. Tardós, University of Zaragoza.
ORB-SLAM2 Copyright (C) 2014-2016 Raúl Mur-Artal, José M.M. Montiel and Juan D. Tardós, University of Zaragoza.
This program comes with ABSOLUTELY NO WARRANTY;
This is free software, and you are welcome to redistribute it
under certain conditions. See LICENSE.txt.

Input sensor was set to: Monocular-Inertial
Loading settings from /home/naoto/docker_workspace/MobilePoser/third_party/pyOrbSlam3/pyOrbSlam3/modules/ORB_SLAM3/Examples/Monocular-Inertial/EuRoC.yaml
Camera1.k3 optional parameter does not exist...
	-Loaded camera 1
	-Loaded image info
IMU.InsertKFsWhenLost optional parameter does not exist...
	-Loaded IMU calibration
	-Loaded ORB settings
Viewer.imageViewScale optional parameter does not exist...
	-Loaded viewer settings
System.LoadAtlasFromFile optional parameter does not exist...
System.SaveAtlasToFile optional parameter does not exist...
	-Loaded Atlas settings
System.thFarPoints optional parameter does not exist...
	-Loaded misc parameters
----------------------------------
SLAM settings: 
	-Camera 1 parameters (Pinhole): [ 458.654 457.296 367.215 248.375 ]
	-Camera 1 distortion parameters: [  -0.283408 0.0739591 0.00019359 1.76187e-05 ]
	-Original image size: [ 752 , 480 ]
	-Current image size: [ 600 , 350 ]
	-Camera 1 parameters after resize: [  365.947 333.445 292.991 181.107 ]
	-Sequence FPS: 20
	-Gyro noise: 0.00017
	-Accelerometer noise: 0.002
	-Gyro walk: 1.9393e-05
	-Accelerometer walk: 0.003
	-IMU frequency: 200
	-Features per image: 1000
	-ORB scale factor: 1.2
	-ORB number of scales: 8
	-Initial FAST threshold: 20
	-Min FAST threshold: 7


Loading ORB Vocabulary. This could take a while...
Vocabulary loaded!

Initialization of Atlas from scratch 
Creation of new map with id: 7
Creation of new map with last KF id: 0
Seq. Name: 
There are 1 cameras in the atlas
Camera 14 is pinhole
Shutdown
INFO:mobileposer.models.real_orbslam3:ORB-SLAM3 visual_inertial system initialized successfully
INFO:mobileposer.slam_data_streaming:Initialized adaptive SLAM system
/home/naoto/.local/lib/python3.12/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:654: Checkpoint directory /home/naoto/docker_workspace/MobilePoser/checkpoints/slam_nymeria/slam_2025-05-31-21:09:13 exists and is not empty.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]

  | Name            | Type        | Params | Mode 
--------------------------------------------------------
0 | pose            | Poser       | 2.7 M  | train
1 | joints          | Joints      | 2.7 M  | train
2 | foot_contact    | FootContact | 174 K  | train
3 | velocity        | Velocity    | 1.1 M  | train
4 | head_fusion_net | Sequential  | 43.5 K | train
5 | confidence_net  | Sequential  | 19.4 K | train
--------------------------------------------------------
6.7 M     Trainable params
0         Non-trainable params
6.7 M     Total params
26.951    Total estimated model params size (MB)
41        Modules in train mode
0         Modules in eval mode
================================================================================
SLAM-Integrated MobilePoser Training
================================================================================
SLAM Type: adaptive
SLAM Enabled: True
SLAM Fusion: True
Dataset: nymeria_aria_xdata_train
Batch Size: 16
Learning Rate: 0.0001
Epochs: 50
================================================================================
INFO:mobileposer.models.adaptive_slam:SLAM mode switch: none -> visual_inertial
INFO:mobileposer.models.adaptive_slam:Enabling SLAM tracking
INFO:mobileposer.models.adaptive_slam:SLAM mode switch: none -> visual_inertial
INFO:mobileposer.models.adaptive_slam:Enabling SLAM tracking
First KF:0; Map init KF:0
New Map created with 228 points
Fail to track local map!
IMU is not or recently initialized. Reseting active map...
INFO:mobileposer.models.adaptive_slam:SLAM mode switch: none -> visual_inertial
INFO:mobileposer.models.adaptive_slam:Enabling SLAM tracking
SYSTEM-> Reseting active map in monocular case
LM: Active map reset recieved
LM: Active map reset, waiting...
First KF:0; Map init KF:0
New Map created with 88 points
Fail to track local map!
IMU is not or recently initialized. Reseting active map...
INFO:mobileposer.models.adaptive_slam:SLAM mode switch: none -> visual_inertial
INFO:mobileposer.models.adaptive_slam:Enabling SLAM tracking
SYSTEM-> Reseting active map in monocular case
LM: Active map reset recieved
LM: Active map reset, waiting...
First KF:0; Map init KF:0
New Map created with 105 points
Fail to track local map!
IMU is not or recently initialized. Reseting active map...
SYSTEM-> Reseting active map in monocular case
LM: Active map reset recieved
LM: Active map reset, waiting...
First KF:0; Map init KF:0
New Map created with 257 points
Fail to track local map!
IMU is not or recently initialized. Reseting active map...
SYSTEM-> Reseting active map in monocular case
LM: Active map reset recieved
LM: Active map reset, waiting...
